<html>
    <script> module = {}; </script>
    <script src="../node_modules/typeson/typeson.js"></script>
    <script>
        var TSON = new Typeson().register({
            Error: [
                function (x) { return x instanceof Error; },
                function (error) { return {name: error.name, message: error.message}; },
                function (data) {
                    var e = new Error (data.message);
                    e.name = data.name;
                    return e;
                }
            ]
        });
        var worker = new Worker("worker.js");
        worker.postMessage (TSON.encapsulate({
            a: NaN,
            b: Infinity,
            c: -Infinity,
            d: new Error("oops")
        }));
        worker.onmessage = function (ev) {
            console.log("Got back: " + ev.data.a);
        }
    </script>
</html>
